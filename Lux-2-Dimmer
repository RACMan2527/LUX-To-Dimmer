blueprint:
  name: Nav LUX Light Dimmer
  description: |
    Version 1.0
    Dim Navigation based on the value of a light sensor
  
  domain: automation
  input:

    light_sensor_entity:
      name: Light Sensor
      selector:
        entity:
          domain: sensor
          device_class: illuminance

    target_light:
      name: Target lights
      selector:
        target:
          entity:
            domain: light

mode: single

variables:
  light_sensor: !input light_sensor_entity

  

trigger:
  platform: state
  entity_id: !input light_sensor_entity

condition:

action:
  - service: light.turn_on
    data:
      brightness_pct: >
        {% if states(light_sensor)|int = 0 }
          1
        {% else %}
        {{ (-0.0000000000000065 * states(light_sensor) * states(light_sensor) * states(light_sensor) * states(light_sensor) )
         + (0.00000000027 * states(light_sensor) * states(light_sensor) *states(light_sensor))
         - ( 0.000004 * states(light_sensor) * states(light_sensor)) 
         + ( 0.0278 * states(light_sensor) )
         + 3.0)|round }}
        {% endif %}

    target: !input target_light
